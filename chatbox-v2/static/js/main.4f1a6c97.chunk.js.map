{"version":3,"sources":["Types.ts","Constants.tsx","ClientId.ts","api/Twitch.ts","Color.js","Contexts.tsx","Utils.ts","Badges.tsx","Content.tsx","Pronouns.tsx","Message.tsx","api/FFZ.ts","api/BTTV.ts","api/7TV.ts","Chat.tsx","App.tsx","Configurator.tsx","images/error.svg","ApiError.tsx","index.tsx"],"names":["ColorAdjustmentMode","TwitchDefaultColors","DefaultConfig","accessToken","fontName","fontSize","fontWeight","fontColor","showBadges","showPronouns","showUserColours","dropShadow","dropShadowBlur","dropShadowOffset","dropShadowColour","outline","outlineThickness","outlineColour","readableColours","readableBackground","readableContrast","readableMode","hslLuma","hideCommands","hideMessages","hideMessagesTimeout","blockedUsers","ClientId","Scopes","TwitchApi","clientId","this","a","logins","ids","params","URLSearchParams","login","append","id","uri","toString","doFetch","path","fetch","headers","response","json","data","ok","hue2rgb","p","q","t","bit2linear","channel","Math","pow","linear2bit","Color","protanope","deuteranope","tritanope","RGBAColor","RGBA","r","g","b","HSVAColor","HSVA","h","s","v","HSLAColor","HSLA","l","XYZAColor","XYZA","x","y","z","LUVAColor","LUVA","u","prototype","eq","rgb","fromName","name","context","_context","canvas","_canvas","document","createElement","getContext","clearRect","fillStyle","fillRect","getImageData","length","fromCSS","trim","charAt","fromHex","match","exec","parseInt","parseFloat","min","max","code","alpha","slice","Error","raw","fromHSVA","i","floor","f","round","undefined","fromXYZA","R","G","B","fromHSLA","toRGBA","toHSVA","fromRGBA","toHSLA","toCSS","toXYZA","toLUVA","toHex","get_Y","luminance","brighten","amount","daltonize","type","cvd","CVDMatrix","hasOwnProperty","cvd_a","cvd_b","cvd_c","cvd_d","cvd_e","cvd_f","cvd_g","cvd_h","cvd_i","L","M","S","m","RR","GG","BB","_r","_g","_b","_a","hsl","d","targetLuminance","target","mid","_h","_s","_l","hsv","_v","xyz","fromLUVA","deltaGammaFactor","WHITE","uDeltaGamma","vDeltagamma","Y","KAPPA","X","_x","_y","_z","EPSILON","luv","Z","yGamma","deltaDivider","deltaFactor","uDelta","vDelta","_u","ColorAdjuster","base","mode","contrast","_contrast","_base","_mode","rebuildContrast","val","_dark","_cache","Map","lum","_luv","_luma","color","throw_errors","has","get","err","luma","out","set","ConfigContext","React","createContext","ColorContext","BadgesContext","EmotesContext","PronounsContext","fetchJSON","Badges","props","configContext","useContext","badgeContext","urls","emoteScale","badges","badgeElements","split","badge","badgeSplit","badgeName","badgeData","badgeVersionNum","badgeVersion","push","className","alt","src","srcSet","map","str","filter","join","Content","text","rawEmotes","emotes","isMe","me","emote","emoteId","indicies","start","end","channelEmotes","idx","nextIdx","indexOf","sort","index","content","key","substr","config","elements","item","Pronouns","pronounsContext","display","pronouns","userMap","nick","displayMap","pronoun","fetchPronouns","Message","state","hidden","timeout","setState","setTimeout","console","log","clearTimeout","Consumer","adjuster","message","rawNick","authorName","toLowerCase","includes","startsWith","authorDisplayName","process","authorColour","charCodeAt","rawBadges","style","Component","contextType","FFZ","BTTV","SevenTV","Chat","connected","messages","cheers","pronounUsers","pronounDisplay","colorAdjuster","load","previousProps","cleanup","errorMessage","twitchApi","getUsers","users","channelId","channelName","connect","localStorage","removeItem","window","location","reload","encodedId","encodeURIComponent","Promise","all","loadBadges","loadEmotes","loadCheers","loadPronouns","events","sevenTvEvents","tmiClient","disconnect","close","client","TMIClient","options","debug","skipUpdatingEmotesets","identity","username","password","channels","addListener","onMessage","bind","userstate","self","chatMessage","oldState","getGlobalBadges","getUserBadges","badgeSets","badgeSetList","badgeSet","set_id","badgeVersions","versions","image_url_1x","image_url_2x","image_url_4x","fetchGlobalEmotes","ffzEmotes","fetchChannelEmotes","images","fetchUser","bttvUser","bttvEmotes","sharedEmotes","sevenTVEmotes","e","sevenTVSubscribe","eventSource","EventSource","addEventListener","ev","eventUpdate","JSON","parse","action","emote_id","delete","pronounsJson","value","userName","pending","Array","isArray","pronoun_id","fill","fontFamily","WebkitTextStroke","stroke","strokeWidth","height","viewBox","width","xmlns","xmlnsXlink","Provider","App","newConfig","decode","Buffer","from","hash","substring","Object","assign","Checkbox","checked","onChange","label","Configurator","connecting","chatConfig","fonts","onWindowMessage","token","getItem","validateToken","queryLocalFonts","then","findIndex","o","family","onValueChange","setItem","newValue","closed","redirectUrl","origin","wnd","open","focus","event","removeEventListener","preventDefault","configDiff","element","configString","btoa","String","fromCharCode","MsgPack","onSubmit","href","renderSignInButton","renderConfigSection","readOnly","margin","onClick","showOAuthWindow","flex","font","placeholder","size","isNaN","title","defaultValue","onBlur","step","ApiError","ErrorSvg","pathname","opener","postMessage","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.4f1a6c97.chunk.js","sourcesContent":["\r\nexport interface Configuration {\r\n  channelName?: string;\r\n  accessToken: string;\r\n\r\n  fontName: string\r\n  fontSize: number\r\n  fontColor: string\r\n  fontWeight: number\r\n\r\n  showBadges: boolean\r\n  showPronouns: boolean\r\n  showUserColours: boolean;\r\n  hideCommands: boolean\r\n\r\n  dropShadow: boolean\r\n  dropShadowColour?: string\r\n  dropShadowOffset?: number\r\n  dropShadowBlur?: number\r\n\r\n  outline: boolean\r\n  outlineThickness?: number;\r\n  outlineColour?: string;\r\n\r\n  readableColours: boolean;\r\n  readableBackground: string;\r\n  readableContrast: number;\r\n  readableMode: ColorAdjustmentMode;\r\n\r\n  hideMessages: boolean;\r\n  hideMessagesTimeout: number;\r\n\r\n  blockedUsers: string[]\r\n}\r\n\r\nexport interface ChatMessage {\r\n  id: string\r\n  content: string  \r\n  type: string;\r\n\r\n  authorName: string;\r\n  authorDisplayName?: string;\r\n  authorColour?: string;\r\n\r\n  rawBadges?: string;\r\n  rawEmotes?: string;\r\n}\r\n\r\nexport interface TwitchEmote {\r\n  id: string\r\n  urls: string[]\r\n  start: number\r\n  end: number\r\n}\r\n\r\nexport interface Emote {\r\n  id: string;\r\n  urls: string[]\r\n  key: string\r\n}\r\n\r\nexport interface CheerTier {\r\n  color: string;\r\n  light: string[];\r\n  dark: string[];\r\n}\r\n\r\nexport interface Cheer {\r\n  prefixes: Map<string, CheerTier>\r\n}\r\n\r\nexport enum ColorAdjustmentMode {\r\n  none,\r\n  hslLuma,\r\n  luv,\r\n  hslLoop,\r\n  rgbLoop\r\n}\r\n\r\nexport interface EmoteEventUpdate {\r\n  // The channel this update affects.\r\n  channel: string;\r\n  // The ID of the emote.\r\n  emote_id: string;\r\n  // The name or channel alias of the emote.\r\n  name: string;\r\n  // The action done.\r\n  action: \"ADD\" | \"REMOVE\" | \"UPDATE\";\r\n  // The user who caused this event to trigger.\r\n  actor: string;\r\n  // An emote object. Null if the action is \"REMOVE\".\r\n  emote?: ExtraEmoteData;\r\n}\r\n\r\ninterface ExtraEmoteData {\r\n  // Original name of the emote.\r\n  name: string;\r\n  // The visibility bitfield of this emote.\r\n  visibility: number;\r\n  // The MIME type of the images.\r\n  mime: string;\r\n  // The TAGs on this emote.\r\n  tags: string[];\r\n  // The widths of the images.\r\n  width: [number, number, number, number];\r\n  // The heights of the images.\r\n  height: [number, number, number, number];\r\n  // The animation status of the emote.\r\n  animated: boolean;\r\n  // Infomation about the uploader.\r\n  owner: {\r\n    // 7TV ID of the owner.\r\n    id: string;\r\n    // Twitch ID of the owner.\r\n    twitch_id: string;\r\n    // Twitch DisplayName of the owner.\r\n    display_name: string;\r\n    // Twitch Login of the owner. \r\n    login: string;\r\n  }\r\n}","import { Configuration, ColorAdjustmentMode } from \"./Types\";\r\n\r\nexport const TwitchDefaultColors = [\"#FF0000\", \"#0000FF\", \"#008000\", \"#B22222\", \"#FF7F50\", \"#9ACD32\", \"#FF4500\", \"#2E8B57\", \"#DAA520\", \"#D2691E\", \"#5F9EA0\", \"#1E90FF\", \"#FF69B4\", \"#8A2BE2\", \"#00FF7F\"];\r\nexport const DefaultConfig: Configuration = {\r\n  accessToken: \"\",\r\n   \r\n  fontName: \"Segoe UI\",\r\n  fontSize: 15,\r\n  fontWeight: 400,\r\n  fontColor: \"#FFFFFF\",\r\n  showBadges: true,\r\n  showPronouns: true,\r\n  showUserColours: true,\r\n\r\n  dropShadow: true,\r\n  dropShadowBlur: 1,\r\n  dropShadowOffset: 1,\r\n  dropShadowColour: \"#000000\",\r\n\r\n  outline: false,\r\n  outlineThickness: 1,\r\n  outlineColour: \"#000000\",\r\n\r\n  readableColours: true,\r\n  readableBackground: \"#212121\",\r\n  readableContrast: 4.5,\r\n  readableMode: ColorAdjustmentMode.hslLuma,\r\n\r\n  hideCommands: true,\r\n  hideMessages: false,\r\n  hideMessagesTimeout: 5000,\r\n\r\n  blockedUsers: ['streamelements', 'streamlabs', 'nightbot', 'moobot', 'fossabot']\r\n}","export const ClientId = 'xvm29ylirdplrgmyhwnzfjih3p2h2c';\r\nexport const Scopes = 'user:read:email%20chat:read%20chat:edit'","import { User, BadgeSet } from \"./TwitchModels\";\r\n\r\nconst HelixBaseUri = \"https://api.twitch.tv/helix\";\r\n\r\nexport class TwitchApi {\r\n    private clientId: string;\r\n    private accessToken: string;\r\n\r\n    constructor(clientId: string, accessToken: string) {\r\n        this.clientId = clientId;\r\n        this.accessToken = accessToken;\r\n    }\r\n\r\n    async getUsers(logins: string[] = [], ids: string[] = []) : Promise<User[]> {\r\n        const params = new URLSearchParams();\r\n        for (const login of logins)\r\n            params.append(\"login\", login);\r\n        for (const id of ids)\r\n            params.append(\"id\", id);\r\n        \r\n        let uri = \"/users?\" + params.toString();\r\n        return await this.doFetch(uri);\r\n    }    \r\n\r\n    async getUserBadges(id: string): Promise<BadgeSet[]> {\r\n        return await this.doFetch(`/chat/badges?broadcaster_id=${id}`);\r\n    }\r\n\r\n    async getGlobalBadges(): Promise<BadgeSet[]> {\r\n        return await this.doFetch(\"/chat/badges/global\");\r\n    }\r\n\r\n    async doFetch(path: string) {\r\n      let response = await fetch(HelixBaseUri + path, { headers: { \"Client-Id\": this.clientId, \"Authorization\" : \"Bearer \" + this.accessToken } });\r\n      let data = await response.json();\r\n      if (!response.ok) {\r\n        throw data;\r\n      }\r\n\r\n      return data.data;\r\n    }\r\n}","export function hue2rgb(p, q, t) {\r\n\tif ( t < 0 ) t += 1;\r\n\tif ( t > 1 ) t -= 1;\r\n\tif ( t < 1/6 )\r\n\t\treturn p + (q-p) * 6 * t;\r\n\tif ( t < 1/2 )\r\n\t\treturn q;\r\n\tif ( t < 2/3 )\r\n\t\treturn p + (q-p) * (2/3 - t) * 6;\r\n\treturn p;\r\n}\r\n\r\nexport function bit2linear(channel) {\r\n\t// http://www.brucelindbloom.com/Eqn_RGB_to_XYZ.html\r\n\t// This converts rgb 8bit to rgb linear, lazy because the other algorithm is really really dumb\r\n\t//return Math.pow(channel, 2.2);\r\n\r\n\t// CSS Colors Level 4 says 0.03928, Bruce Lindbloom who cared to write all algos says 0.04045, used bruce because whynawt\r\n\treturn (channel <= 0.04045) ? channel / 12.92 : Math.pow((channel + 0.055) / 1.055, 2.4);\r\n}\r\n\r\nexport function linear2bit(channel) {\r\n\t// Using lazy conversion in the other direction as well\r\n\t//return Math.pow(channel, 1/2.2);\r\n\r\n\t// I'm honestly not sure about 0.0031308, I've only seen it referenced on Bruce Lindbloom's site\r\n\treturn (channel <= 0.0031308) ? channel * 12.92 : Math.pow(1.055 * channel, 1/2.4) - 0.055;\r\n}\r\n\r\n\r\nexport const Color = {};\r\n\r\nColor._canvas = null;\r\nColor._context = null;\r\n\r\nColor.CVDMatrix = {\r\n\tprotanope: [ // reds are greatly reduced (1% men)\r\n\t\t0.0, 2.02344, -2.52581,\r\n\t\t0.0, 1.0,      0.0,\r\n\t\t0.0, 0.0,      1.0\r\n\t],\r\n\tdeuteranope: [ // greens are greatly reduced (1% men)\r\n\t\t1.0,      0.0, 0.0,\r\n\t\t0.494207, 0.0, 1.24827,\r\n\t\t0.0,      0.0, 1.0\r\n\t],\r\n\ttritanope: [ // blues are greatly reduced (0.003% population)\r\n\t\t1.0,       0.0,      0.0,\r\n\t\t0.0,       1.0,      0.0,\r\n\t\t-0.395913, 0.801109, 0.0\r\n\t]\r\n}\r\n\r\n\r\nconst RGBAColor = Color.RGBA = function(r, g, b, a) {\r\n\tthis.r = r||0; this.g = g||0; this.b = b||0; this.a = a||0;\r\n};\r\n\r\nconst HSVAColor = Color.HSVA = function(h, s, v, a) {\r\n\tthis.h = h||0; this.s = s||0; this.v = v||0; this.a = a||0;\r\n};\r\n\r\nconst HSLAColor = Color.HSLA = function(h, s, l, a) {\r\n\tthis.h = h||0; this.s = s||0; this.l = l||0; this.a = a||0;\r\n};\r\n\r\nconst XYZAColor = Color.XYZA = function(x, y, z, a) {\r\n\tthis.x = x||0; this.y = y||0; this.z = z||0; this.a = a||0;\r\n};\r\n\r\nconst LUVAColor = Color.LUVA = function(l, u, v, a) {\r\n\tthis.l = l||0; this.u = u||0; this.v = v||0; this.a = a||0;\r\n};\r\n\r\n\r\n// RGBA Colors\r\n\r\nRGBAColor.prototype.eq = function(rgb) {\r\n\treturn rgb.r === this.r && rgb.g === this.g && rgb.b === this.b && rgb.a === this.a;\r\n}\r\n\r\nRGBAColor.fromName = function(name) {\r\n\tlet context = Color._context;\r\n\tif ( ! context ) {\r\n\t\tconst canvas = Color._canvas = document.createElement('canvas');\r\n\t\tcontext = Color._context = canvas.getContext('2d');\r\n\t}\r\n\r\n\tcontext.clearRect(0,0,1,1);\r\n\tcontext.fillStyle = name;\r\n\tcontext.fillRect(0,0,1,1);\r\n\tconst data = context.getImageData(0,0,1,1);\r\n\r\n\tif ( ! data || ! data.data || data.data.length !== 4 )\r\n\t\treturn null;\r\n\r\n\treturn new RGBAColor(data.data[0], data.data[1], data.data[2], data.data[3] / 255);\r\n}\r\n\r\nRGBAColor.fromCSS = function(rgb) {\r\n\tif ( ! rgb )\r\n\t\treturn null;\r\n\r\n\trgb = rgb.trim();\r\n\r\n\tif ( rgb.charAt(0) === '#' )\r\n\t\treturn RGBAColor.fromHex(rgb);\r\n\r\n\tconst match = /rgba?\\( *(\\d+%?) *, *(\\d+%?) *, *(\\d+%?) *(?:, *([\\d.]+))?\\)/i.exec(rgb);\r\n\tif ( match ) {\r\n\t\tlet r = match[1],\r\n\t\t\tg = match[2],\r\n\t\t\tb = match[3],\r\n\t\t\ta = match[4];\r\n\r\n\t\tif ( r.charAt(r.length-1) === '%' )\r\n\t\t\tr = 255 * (parseInt(r,10) / 100);\r\n\t\telse\r\n\t\t\tr = parseInt(r,10);\r\n\r\n\t\tif ( g.charAt(g.length-1) === '%' )\r\n\t\t\tg = 255 * (parseInt(g,10) / 100);\r\n\t\telse\r\n\t\t\tg = parseInt(g,10);\r\n\r\n\t\tif ( b.charAt(b.length-1) === '%' )\r\n\t\t\tb = 255 * (parseInt(b,10) / 100);\r\n\t\telse\r\n\t\t\tb = parseInt(b,10);\r\n\r\n\t\tif ( a )\r\n\t\t\tif ( a.charAt(a.length-1) === '%' )\r\n\t\t\t\ta = parseInt(a,10) / 100;\r\n\t\t\telse\r\n\t\t\t\ta = parseFloat(a);\r\n\t\telse\r\n\t\t\ta = 1;\r\n\r\n\t\treturn new RGBAColor(\r\n\t\t\tMath.min(Math.max(0, r), 255),\r\n\t\t\tMath.min(Math.max(0, g), 255),\r\n\t\t\tMath.min(Math.max(0, b), 255),\r\n\t\t\tMath.min(Math.max(0, a), 1)\r\n\t\t);\r\n\t}\r\n\r\n\treturn RGBAColor.fromName(rgb);\r\n}\r\n\r\nRGBAColor.fromHex = function(code, alpha = 1) {\r\n\tif ( code.charAt(0) === '#' )\r\n\t\tcode = code.slice(1);\r\n\r\n\tif ( code.length === 3 )\r\n\t\tcode = `${code[0]}${code[0]}${code[1]}${code[1]}${code[2]}${code[2]}`;\r\n\r\n\telse if ( code.length === 4 )\r\n\t\tcode = `${code[0]}${code[0]}${code[1]}${code[1]}${code[2]}${code[2]}${code[3]}${code[3]}`;\r\n\r\n\tif ( code.length === 8 ) {\r\n\t\talpha = parseInt(code.slice(6), 16) / 255;\r\n\t\tcode = code.slice(0, 6);\r\n\r\n\t} else if ( code.length !== 6 )\r\n\t\tthrow new Error('invalid hex code');\r\n\r\n\tconst raw = parseInt(code, 16);\r\n\treturn new RGBAColor(\r\n\t\t(raw >> 16),\t\t // Red\r\n\t\t(raw >> 8 & 0x00FF), // Green\r\n\t\t(raw & 0x0000FF),    // Blue,\r\n\t\talpha                // Alpha\r\n\t);\r\n}\r\n\r\nRGBAColor.fromHSVA = function(h, s, v, a) {\r\n\tlet r, g, b;\r\n\r\n\tconst i = Math.floor(h * 6),\r\n\t\tf = h * 6 - i,\r\n\t\tp = v * (1 - s),\r\n\t\tq = v * (1 - f * s),\r\n\t\tt = v * (1 - (1 - f) * s);\r\n\r\n\tswitch(i % 6) {\r\n\t\tcase 0: r = v; g = t; b = p; break;\r\n\t\tcase 1: r = q; g = v; b = p; break;\r\n\t\tcase 2: r = p; g = v; b = t; break;\r\n\t\tcase 3: r = p; g = q; b = v; break;\r\n\t\tcase 4: r = t; g = p; b = v; break;\r\n\t\tcase 5: r = v; g = p; b = q;\r\n\t}\r\n\r\n\treturn new RGBAColor(\r\n\t\tMath.round(Math.min(Math.max(0, r*255), 255)),\r\n\t\tMath.round(Math.min(Math.max(0, g*255), 255)),\r\n\t\tMath.round(Math.min(Math.max(0, b*255), 255)),\r\n\t\ta === undefined ? 1 : a\r\n\t);\r\n}\r\n\r\nRGBAColor.fromXYZA = function(x, y, z, a) {\r\n\tconst R =  3.240479 * x - 1.537150 * y - 0.498535 * z,\r\n\t\tG = -0.969256 * x + 1.875992 * y + 0.041556 * z,\r\n\t\tB =  0.055648 * x - 0.204043 * y + 1.057311 * z;\r\n\r\n\t// Make sure we end up in a real color space\r\n\treturn new RGBAColor(\r\n\t\tMath.max(0, Math.min(255, 255 * linear2bit(R))),\r\n\t\tMath.max(0, Math.min(255, 255 * linear2bit(G))),\r\n\t\tMath.max(0, Math.min(255, 255 * linear2bit(B))),\r\n\t\ta === undefined ? 1 : a\r\n\t);\r\n}\r\n\r\nRGBAColor.fromHSLA = function(h, s, l, a) {\r\n\tif ( s === 0 ) {\r\n\t\tconst v = Math.round(Math.min(Math.max(0, 255*l), 255));\r\n\t\treturn new RGBAColor(v, v, v, a === undefined ? 1 : a);\r\n\t}\r\n\r\n\tconst q = l < 0.5 ? l * (1 + s) : l + s - l * s,\r\n\t\tp = 2 * l - q;\r\n\r\n\treturn new RGBAColor(\r\n\t\tMath.round(Math.min(Math.max(0, 255 * hue2rgb(p, q, h + 1/3)), 255)),\r\n\t\tMath.round(Math.min(Math.max(0, 255 * hue2rgb(p, q, h)), 255)),\r\n\t\tMath.round(Math.min(Math.max(0, 255 * hue2rgb(p, q, h - 1/3)), 255)),\r\n\t\ta === undefined ? 1 : a\r\n\t);\r\n}\r\n\r\nRGBAColor.prototype.toRGBA = function() { return this; }\r\nRGBAColor.prototype.toHSVA = function() { return HSVAColor.fromRGBA(this.r, this.g, this.b, this.a); }\r\nRGBAColor.prototype.toHSLA = function() { return HSLAColor.fromRGBA(this.r, this.g, this.b, this.a); }\r\nRGBAColor.prototype.toCSS = function() { return `rgb${this.a !== 1 ? 'a' : ''}(${Math.round(this.r)},${Math.round(this.g)},${Math.round(this.b)}${this.a !== 1 ? `,${this.a}` : ''})`; }\r\nRGBAColor.prototype.toXYZA = function() { return XYZAColor.fromRGBA(this.r, this.g, this.b, this.a); }\r\nRGBAColor.prototype.toLUVA = function() { return this.toXYZA().toLUVA(); }\r\n\r\nRGBAColor.prototype.toHex = function() {\r\n\tconst rgb = this.b | (this.g << 8) | (this.r << 16);\r\n\treturn `#${(0x1000000 + rgb).toString(16).slice(1)}`;\r\n}\r\n\r\n\r\nRGBAColor.prototype.get_Y = function() {\r\n\treturn ((0.299 * this.r) + ( 0.587 * this.g) + ( 0.114 * this.b)) / 255;\r\n}\r\n\r\n\r\nRGBAColor.prototype.luminance = function() {\r\n\tconst r = bit2linear(this.r / 255),\r\n\t\tg = bit2linear(this.g / 255),\r\n\t\tb = bit2linear(this.b / 255);\r\n\r\n\treturn (0.2126 * r) + (0.7152 * g) + (0.0722 * b);\r\n}\r\n\r\n\r\nRGBAColor.prototype.brighten = function(amount) {\r\n\tamount = typeof amount === `number` ? amount : 1;\r\n\tamount = Math.round(255 * (amount / 100));\r\n\r\n\treturn new RGBAColor(\r\n\t\tMath.max(0, Math.min(255, this.r + amount)),\r\n\t\tMath.max(0, Math.min(255, this.g + amount)),\r\n\t\tMath.max(0, Math.min(255, this.b + amount)),\r\n\t\tthis.a\r\n\t);\r\n}\r\n\r\n\r\nRGBAColor.prototype.daltonize = function(type) {\r\n\tlet cvd;\r\n\tif ( typeof type === 'string' ) {\r\n\t\tif ( Color.CVDMatrix.hasOwnProperty(type) )\r\n\t\t\tcvd = Color.CVDMatrix[type];\r\n\t\telse\r\n\t\t\tthrow new Error('Invalid CVD matrix');\r\n\t} else\r\n\t\tcvd = type;\r\n\r\n\tconst cvd_a = cvd[0], cvd_b = cvd[1], cvd_c = cvd[2],\r\n\t\tcvd_d = cvd[3], cvd_e = cvd[4], cvd_f = cvd[5],\r\n\t\tcvd_g = cvd[6], cvd_h = cvd[7], cvd_i = cvd[8];\r\n\r\n\t//let L, M, S, l, m, s, R, G, B, RR, GG, BB;\r\n\r\n\t// RGB to LMS matrix conversion\r\n\tconst L = (17.8824 * this.r) + (43.5161 * this.g) + (4.11935 * this.b),\r\n\t\tM = (3.45565 * this.r) + (27.1554 * this.g) + (3.86714 * this.b),\r\n\t\tS = (0.0299566 * this.r) + (0.184309 * this.g) + (1.46709 * this.b);\r\n\r\n\t// Simulate color blindness\r\n\tconst l = (cvd_a * L) + (cvd_b * M) + (cvd_c * S),\r\n\t\tm = (cvd_d * L) + (cvd_e * M) + (cvd_f * S),\r\n\t\ts = (cvd_g * L) + (cvd_h * M) + (cvd_i * S);\r\n\r\n\t// LMS to RGB matrix conversion\r\n\tlet R = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s),\r\n\t\tG = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s),\r\n\t\tB = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\r\n\r\n\t// Isolate invisible colors to color vision deficiency (calculate error matrix)\r\n\tR = this.r - R;\r\n\tG = this.g - G;\r\n\tB = this.b - B;\r\n\r\n\t// Shift colors towards visible spectrum (apply error modifications)\r\n\tconst RR = (0.0 * R) + (0.0 * G) + (0.0 * B),\r\n\t\tGG = (0.7 * R) + (1.0 * G) + (0.0 * B),\r\n\t\tBB = (0.7 * R) + (0.0 * G) + (1.0 * B);\r\n\r\n\t// Add compensation to original values\r\n\tR = Math.min(Math.max(0, RR + this.r), 255);\r\n\tG = Math.min(Math.max(0, GG + this.g), 255);\r\n\tB = Math.min(Math.max(0, BB + this.b), 255);\r\n\r\n\treturn new RGBAColor(R, G, B, this.a);\r\n}\r\n\r\nRGBAColor.prototype._r = function(r) { return new RGBAColor(r, this.g, this.b, this.a); }\r\nRGBAColor.prototype._g = function(g) { return new RGBAColor(this.r, g, this.b, this.a); }\r\nRGBAColor.prototype._b = function(b) { return new RGBAColor(this.r, this.g, b, this.a); }\r\nRGBAColor.prototype._a = function(a) { return new RGBAColor(this.r, this.g, this.b, a); }\r\n\r\n\r\n// HSL Colors\r\n\r\nHSLAColor.prototype.eq = function(hsl) {\r\n\treturn hsl.h === this.h && hsl.s === this.s && hsl.l === this.l && hsl.a === this.a;\r\n}\r\n\r\nHSLAColor.fromRGBA = function(r, g, b, a) {\r\n\tr /= 255; g /= 255; b /= 255;\r\n\r\n\tconst max = Math.max(r,g,b),\r\n\t\tmin = Math.min(r,g,b),\r\n\r\n\t\tl = Math.min(Math.max(0, (max+min) / 2), 1),\r\n\t\td = Math.min(Math.max(0, max - min), 1);\r\n\r\n\tlet h, s;\r\n\r\n\tif ( d === 0 )\r\n\t\th = s = 0;\r\n\telse {\r\n\t\ts = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n\t\tswitch(max) {\r\n\t\t\tcase r:\r\n\t\t\t\th = (g - b) / d + (g < b ? 6 : 0);\r\n\t\t\t\tbreak;\r\n\t\t\tcase g:\r\n\t\t\t\th = (b - r) / d + 2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase b:\r\n\t\t\t\th = (r - g) / d + 4;\r\n\t\t}\r\n\t\th /= 6;\r\n\t}\r\n\r\n\treturn new HSLAColor(h, s, l, a === undefined ? 1 : a);\r\n}\r\n\r\nHSLAColor.prototype.targetLuminance = function (target) {\r\n\tlet s = this.s,\r\n\t\tmin = 0,\r\n\t\tmax = 1;\r\n\r\n\ts *= Math.pow(this.l > 0.5 ? -this.l : this.l - 1, 7) + 1;\r\n\r\n\tlet d = (max - min) / 2,\r\n\t\tmid = min + d;\r\n\r\n\tfor (; d > 1/65536; d /= 2, mid = min + d) {\r\n\t\tconst luminance = RGBAColor.fromHSLA(this.h, s, mid, 1).luminance()\r\n\t\tif (luminance > target) {\r\n\t\t\tmax = mid;\r\n\t\t} else {\r\n\t\t\tmin = mid;\r\n\t\t}\r\n\t}\r\n\r\n\treturn new HSLAColor(this.h, s, mid, this.a);\r\n}\r\n\r\nHSLAColor.prototype.toRGBA = function() { return RGBAColor.fromHSLA(this.h, this.s, this.l, this.a); }\r\nHSLAColor.prototype.toCSS = function() { return `hsl${this.a !== 1 ? 'a' : ''}(${Math.round(this.h*360)},${Math.round(this.s*100)}%,${Math.round(this.l*100)}%${this.a !== 1 ? `,${this.a}` : ''})`; }\r\nHSLAColor.prototype.toHSLA = function() { return this; }\r\nHSLAColor.prototype.toHSVA = function() { return this.toRGBA().toHSVA(); }\r\nHSLAColor.prototype.toXYZA = function() { return this.toRGBA().toXYZA(); }\r\nHSLAColor.prototype.toLUVA = function() { return this.toRGBA().toLUVA(); }\r\n\r\n\r\nHSLAColor.prototype._h = function(h) { return new HSLAColor(h, this.s, this.l, this.a); }\r\nHSLAColor.prototype._s = function(s) { return new HSLAColor(this.h, s, this.l, this.a); }\r\nHSLAColor.prototype._l = function(l) { return new HSLAColor(this.h, this.s, l, this.a); }\r\nHSLAColor.prototype._a = function(a) { return new HSLAColor(this.h, this.s, this.l, a); }\r\n\r\n\r\n// HSV Colors\r\n\r\nHSVAColor.prototype.eq = function(hsv) { return hsv.h === this.h && hsv.s === this.s && hsv.v === this.v && hsv.a === this.a; }\r\n\r\nHSVAColor.fromRGBA = function(r, g, b, a) {\r\n\tr /= 255; g /= 255; b /= 255;\r\n\r\n\tconst max = Math.max(r, g, b),\r\n\t\tmin = Math.min(r, g, b),\r\n\t\td = Math.min(Math.max(0, max - min), 1),\r\n\r\n\t\ts = max === 0 ? 0 : d / max,\r\n\t\tv = max;\r\n\r\n\tlet h;\r\n\r\n\tif ( d === 0 )\r\n\t\th = 0;\r\n\telse {\r\n\t\tswitch(max) {\r\n\t\t\tcase r:\r\n\t\t\t\th = (g - b) / d + (g < b ? 6 : 0);\r\n\t\t\t\tbreak;\r\n\t\t\tcase g:\r\n\t\t\t\th = (b - r) / d + 2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase b:\r\n\t\t\t\th = (r - g) / d + 4;\r\n\t\t}\r\n\t\th /= 6;\r\n\t}\r\n\r\n\treturn new HSVAColor(h, s, v, a === undefined ? 1 : a);\r\n}\r\n\r\n\r\nHSVAColor.prototype.toRGBA = function() { return RGBAColor.fromHSVA(this.h, this.s, this.v, this.a); }\r\nHSVAColor.prototype.toHSVA = function() { return this; }\r\nHSVAColor.prototype.toHSLA = function() { return this.toRGBA().toHSLA(); }\r\nHSVAColor.prototype.toXYZA = function() { return this.toRGBA().toXYZA(); }\r\nHSVAColor.prototype.toLUVA = function() { return this.toRGBA().toLUVA(); }\r\n\r\n\r\nHSVAColor.prototype._h = function(h) { return new HSVAColor(h, this.s, this.v, this.a); }\r\nHSVAColor.prototype._s = function(s) { return new HSVAColor(this.h, s, this.v, this.a); }\r\nHSVAColor.prototype._v = function(v) { return new HSVAColor(this.h, this.s, v, this.a); }\r\nHSVAColor.prototype._a = function(a) { return new HSVAColor(this.h, this.s, this.v, a); }\r\n\r\n\r\n// XYZ Colors\r\n\r\nXYZAColor.prototype.eq = function(xyz) {  return xyz.x === this.x && xyz.y === this.y && xyz.z === this.z; }\r\n\r\nXYZAColor.fromRGBA = function(r, g, b, a) {\r\n\tconst R = bit2linear(r / 255),\r\n\t\tG = bit2linear(g / 255),\r\n\t\tB = bit2linear(b / 255);\r\n\r\n\treturn new XYZAColor(\r\n\t\t0.412453 * R + 0.357580 * G + 0.180423 * B,\r\n\t\t0.212671 * R + 0.715160 * G + 0.072169 * B,\r\n\t\t0.019334 * R + 0.119193 * G + 0.950227 * B,\r\n\t\ta === undefined ? 1 : a\r\n\t);\r\n}\r\n\r\nXYZAColor.fromLUVA = function(l, u, v, alpha) {\r\n\tconst deltaGammaFactor = 1 / (XYZAColor.WHITE.x + 15 * XYZAColor.WHITE.y + 3 * XYZAColor.WHITE.z),\r\n\t\tuDeltaGamma = 4 * XYZAColor.WHITE.x * deltaGammaFactor,\r\n\t\tvDeltagamma = 9 * XYZAColor.WHITE.y * deltaGammaFactor;\r\n\r\n\t// XYZAColor.EPSILON * XYZAColor.KAPPA = 8\r\n\tconst Y = (l > 8) ? Math.pow((l + 16) / 116, 3) : l / XYZAColor.KAPPA,\r\n\t\ta = 1/3 * (((52 * l) / (u + 13 * l * uDeltaGamma)) - 1),\r\n\t\tb = -5 * Y,\r\n\t\tc = -1/3,\r\n\t\td = Y * (((39 * l) / (v + 13 * l * vDeltagamma)) - 5),\r\n\r\n\t\tX = (d - b) / (a - c),\r\n\t\tZ = X * a + b;\r\n\r\n\treturn new XYZAColor(X, Y, Z, alpha === undefined ? 1 : alpha);\r\n}\r\n\r\n\r\nXYZAColor.prototype.toRGBA = function() { return RGBAColor.fromXYZA(this.x, this.y, this.z, this.a); }\r\nXYZAColor.prototype.toLUVA = function() { return LUVAColor.fromXYZA(this.x, this.y, this.z, this.a); }\r\nXYZAColor.prototype.toHSLA = function() { return this.toRGBA().toHSLA(); }\r\nXYZAColor.prototype.toHSVA = function() { return this.toRGBA().toHSVA(); }\r\nXYZAColor.prototype.toXYZA = function() { return this; }\r\n\r\n\r\nXYZAColor.prototype._x = function(x) { return new XYZAColor(x, this.y, this.z, this.a); }\r\nXYZAColor.prototype._y = function(y) { return new XYZAColor(this.x, y, this.z, this.a); }\r\nXYZAColor.prototype._z = function(z) { return new XYZAColor(this.x, this.y, z, this.a); }\r\nXYZAColor.prototype._a = function(a) { return new XYZAColor(this.x, this.y, this.z, a); }\r\n\r\n\r\n// LUV Colors\r\n\r\nXYZAColor.EPSILON = Math.pow(6 / 29, 3);\r\nXYZAColor.KAPPA = Math.pow(29 / 3, 3);\r\nXYZAColor.WHITE = (new RGBAColor(255, 255, 255, 1)).toXYZA();\r\n\r\n\r\nLUVAColor.prototype.eq = function(luv) { return luv.l === this.l && luv.u === this.u && luv.v === this.v; }\r\n\r\nLUVAColor.fromXYZA = function(X, Y, Z, a) {\r\n\tconst deltaGammaFactor = 1 / (XYZAColor.WHITE.x + 15 * XYZAColor.WHITE.y + 3 * XYZAColor.WHITE.z),\r\n\t\tuDeltaGamma = 4 * XYZAColor.WHITE.x * deltaGammaFactor,\r\n\t\tvDeltagamma = 9 * XYZAColor.WHITE.y * deltaGammaFactor,\r\n\r\n\t\tyGamma = Y / XYZAColor.WHITE.y;\r\n\r\n\tlet deltaDivider = (X + 15 * Y + 3 * Z);\r\n\tif (deltaDivider === 0) {\r\n\t\tdeltaDivider = 1;\r\n\t}\r\n\r\n\tconst deltaFactor = 1 / deltaDivider,\r\n\r\n\t\tuDelta = 4 * X * deltaFactor,\r\n\t\tvDelta = 9 * Y * deltaFactor,\r\n\r\n\t\tL = (yGamma > XYZAColor.EPSILON) ? 116 * Math.pow(yGamma, 1/3) - 16 : XYZAColor.KAPPA * yGamma,\r\n\t\tu = 13 * L * (uDelta - uDeltaGamma),\r\n\t\tv = 13 * L * (vDelta - vDeltagamma);\r\n\r\n\treturn new LUVAColor(L, u, v, a === undefined ? 1 : a);\r\n}\r\n\r\n\r\nLUVAColor.prototype.toXYZA = function() { return XYZAColor.fromLUVA(this.l, this.u, this.v, this.a); }\r\nLUVAColor.prototype.toRGBA = function() { return this.toXYZA().toRGBA(); }\r\nLUVAColor.prototype.toHSLA = function() { return this.toXYZA().toHSLA(); }\r\nLUVAColor.prototype.toHSVA = function() { return this.toXYZA().toHSVA(); }\r\nLUVAColor.prototype.toLUVA = function() { return this; }\r\n\r\n\r\nLUVAColor.prototype._l = function(l) { return new LUVAColor(l, this.u, this.v, this.a); }\r\nLUVAColor.prototype._u = function(u) { return new LUVAColor(this.l, u, this.v, this.a); }\r\nLUVAColor.prototype._v = function(v) { return new LUVAColor(this.l, this.u, v, this.a); }\r\nLUVAColor.prototype._a = function(a) { return new LUVAColor(this.l, this.u, this.v, a); }\r\n\r\n\r\n\r\nexport class ColorAdjuster {\r\n\tconstructor(base = '#232323', mode = 0, contrast = 4.5) {\r\n\t\tthis._contrast = contrast;\r\n\t\tthis._base = base;\r\n\t\tthis._mode = mode;\r\n\r\n\t\tthis.rebuildContrast();\r\n\t}\r\n\r\n\tget contrast() { return this._contrast }\r\n\tset contrast(val) { this._contrast = val; this.rebuildContrast() }\r\n\r\n\tget base() { return this._base }\r\n\tset base(val) { this._base = val; this.rebuildContrast() }\r\n\r\n\tget dark() { return this._dark }\r\n\r\n\tget mode() { return this._mode }\r\n\tset mode(val) { this._mode = val; this.rebuildContrast() }\r\n\r\n\r\n\trebuildContrast() {\r\n\t\tthis._cache = new Map();\r\n\r\n\t\tconst base = RGBAColor.fromCSS(this._base),\r\n\t\t\tlum = base.luminance();\r\n\r\n\t\tconst dark = this._dark = lum < 0.33;\r\n\r\n\t\tif ( dark ) {\r\n\t\t\tthis._luv = new XYZAColor(\r\n\t\t\t\t0,\r\n\t\t\t\t(this._contrast * (base.toXYZA().y + 0.05) - 0.05),\r\n\t\t\t\t0,\r\n\t\t\t\t1\r\n\t\t\t).toLUVA().l;\r\n\r\n\t\t\tthis._luma = this._contrast * (base.luminance() + 0.05) - 0.05;\r\n\r\n\t\t} else {\r\n\t\t\tthis._luv = new XYZAColor(\r\n\t\t\t\t0,\r\n\t\t\t\t(base.toXYZA().y + 0.05) / this._contrast - 0.05,\r\n\t\t\t\t0,\r\n\t\t\t\t1\r\n\t\t\t).toLUVA().l;\r\n\r\n\t\t\tthis._luma = (base.luminance() + 0.05) / this._contrast - 0.05;\r\n\t\t}\r\n\t}\r\n\r\n\tprocess(color, throw_errors = false) {\r\n\t\tif ( this._mode === -1 )\r\n\t\t\treturn '';\r\n\t\telse if ( this._mode === 0 )\r\n\t\t\treturn color;\r\n\r\n\t\tif ( color instanceof RGBAColor )\r\n\t\t\tcolor = color.toCSS();\r\n\r\n\t\tif ( ! color )\r\n\t\t\treturn null;\r\n\r\n\t\tif ( this._cache.has(color) )\r\n\t\t\treturn this._cache.get(color);\r\n\r\n\t\tlet rgb;\r\n\r\n\t\ttry {\r\n\t\t\trgb = RGBAColor.fromCSS(color);\r\n\t\t} catch(err) {\r\n\t\t\tif ( throw_errors )\r\n\t\t\t\tthrow err;\r\n\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif ( this._mode === 1 ) {\r\n\t\t\t// HSL Luma\r\n\t\t\tconst luma = rgb.luminance();\r\n\r\n\t\t\tif ( this._dark ? luma < this._luma : luma > this._luma )\r\n\t\t\t\trgb = rgb.toHSLA().targetLuminance(this._luma).toRGBA();\r\n\r\n\t\t} else if ( this._mode === 2 ) {\r\n\t\t\t// LUV\r\n\t\t\tconst luv = rgb.toLUVA();\r\n\t\t\tif ( this._dark ? luv.l < this._luv : luv.l > this._luv )\r\n\t\t\t\trgb = luv._l(this._luv).toRGBA();\r\n\r\n\t\t} else if ( this._mode === 3 ) {\r\n\t\t\t// HSL Loop (aka BTTV Style)\r\n\t\t\tif ( this._dark )\r\n\t\t\t\twhile ( rgb.get_Y() < 0.5 ) {\r\n\t\t\t\t\tconst hsl = rgb.toHSLA();\r\n\t\t\t\t\trgb = hsl._l(Math.min(Math.max(0, 0.1 + 0.9 * hsl.l), 1)).toRGBA();\r\n\t\t\t\t}\r\n\r\n\t\t\telse\r\n\t\t\t\twhile ( rgb.get_Y() >= 0.5 ) {\r\n\t\t\t\t\tconst hsl = rgb.toHSLA();\r\n\t\t\t\t\trgb = hsl._l(Math.min(Math.max(0, 0.9 * hsl.l), 1)).toRGBA();\r\n\t\t\t\t}\r\n\r\n\t\t} else if ( this._mode === 4 ) {\r\n\t\t\t// RGB Loop\r\n\t\t\tlet i = 0;\r\n\t\t\tif ( this._dark )\r\n\t\t\t\twhile ( rgb.luminance() < 0.15 && i++ < 127 )\r\n\t\t\t\t\trgb = rgb.brighten();\r\n\r\n\t\t\telse\r\n\t\t\t\twhile ( rgb.luminance() > 0.3 && i++ < 127 )\r\n\t\t\t\t\trgb = rgb.brighten(-1);\r\n\t\t}\r\n\r\n\t\tconst out = rgb.toCSS();\r\n\t\tthis._cache.set(color, out);\r\n\t\treturn out;\r\n\t}\r\n}","import React from 'react';\r\nimport { Configuration } from \"./Types\";\r\nimport { ColorAdjuster } from './Color';\r\nimport { Pronouns } from './Chat';\r\n\r\nexport const ConfigContext = React.createContext<Configuration | null>(null);\r\nexport const ColorContext = React.createContext<ColorAdjuster>(new ColorAdjuster());\r\nexport const BadgesContext = React.createContext<Map<string, string[][]>>(new Map());\r\nexport const EmotesContext = React.createContext<Map<string, string[]>>(new Map());\r\nexport const PronounsContext = React.createContext<Pronouns | null>(null);\r\n","export const fetchJSON = async (path: string) => {\r\n  let response = await fetch(path);\r\n  return await response.json();\r\n}\r\n\r\nexport const createBadgeSrcSet = (urls: string[]) => {\r\n  // const scaleMap = [\"18px\", \"28px\", \"36px\", \"54px\"]\r\n  return urls.map((str, i) => !!str ? (i === 0 ? `${str}` : `${str} ${i + 1}x`) : null)\r\n             .filter(x => !!x)\r\n             .join(', ')\r\n};\r\n\r\nexport const createEmoteSrcSet = (urls: string[]) => {\r\n  // const scaleMap = [\"28px\", \"42px\", \"56px\", \"84px\"]\r\n  return urls.map((str, i) => !!str ? (i === 0 ? `${str}` : `${str} ${i + 1}x`) : null)\r\n             .filter(x => !!x)\r\n             .join(', ')\r\n};","import { BadgesContext, ConfigContext } from \"./Contexts\";\r\nimport React, { useContext } from 'react';\r\nimport { createBadgeSrcSet } from \"./Utils\";\r\nimport { BadgeInfo } from \"tmi.js\";\r\n\r\ninterface BadgesProps {\r\n  badges?: string\r\n}\r\n\r\nexport const Badges = (props: BadgesProps) => {\r\n  const configContext = useContext(ConfigContext);\r\n  const badgeContext = useContext(BadgesContext);\r\n\r\n  if (!configContext?.showBadges) return null;\r\n\r\n  let emoteScale = Math.max(1, Math.min(4, Math.round(configContext!.fontSize / 15)))\r\n  let badges = props.badges ?? \"\";\r\n  let badgeElements: Array<any> = [];\r\n  for (const badge of badges.split(',')) {\r\n    let badgeSplit = badge.split(\"/\")\r\n    let badgeName = badgeSplit[0];\r\n    let badgeData = badgeContext.get(badgeName);\r\n    if (!badgeData) continue;\r\n\r\n    let badgeVersionNum = parseInt(badgeSplit[1]);\r\n    let badgeVersion = badgeData[Math.max(0, Math.min(badgeVersionNum, badgeData.length - 1))];\r\n    \r\n    badgeElements.push(<img className={\"badge badge-scale-\" + emoteScale} alt={\"\"} key={badge} src={badgeVersion[0]} srcSet={createBadgeSrcSet(badgeVersion)} />)\r\n  }\r\n\r\n  return (\r\n    <>{badgeElements}</>\r\n  )\r\n}","import React, { useContext } from 'react';\r\nimport { ConfigContext, EmotesContext } from \"./Contexts\";\r\nimport { Emote, TwitchEmote } from './Types';\r\nimport { createEmoteSrcSet } from './Utils';\r\n\r\ninterface ContentProps {\r\n  text: string;\r\n  emotes?: string;\r\n  me?: boolean;\r\n}\r\n\r\nexport const Content = (props: ContentProps) => {\r\n  let text = props.text;\r\n  let rawEmotes = props.emotes ?? \"\"\r\n\r\n  // this has to be done before you parse emotes\r\n  let isMe = props.me !== undefined ? props.me : false;\r\n\r\n  // emotes appear as <emoteid>:<start>-<end>,<start>-<end>/ (e.g. 302347771:16-26,33-43)\r\n  let emotes: Array<TwitchEmote> = [];\r\n  for (const emote of rawEmotes.split('/')) {\r\n    if (!emote) continue;\r\n\r\n    const [emoteId, indicies] = emote.split(':');\r\n    for (const indexSet of indicies.split(',')) {\r\n      const [start, end] = indexSet.split('-');\r\n      emotes.push({\r\n        id: emoteId,\r\n        urls: [\r\n          `https://static-cdn.jtvnw.net/emoticons/v2/${emoteId}/default/dark/1.0`,\r\n          `https://static-cdn.jtvnw.net/emoticons/v2/${emoteId}/default/dark/2.0`,\r\n          `https://static-cdn.jtvnw.net/emoticons/v2/${emoteId}/default/dark/3.0`,\r\n        ],\r\n        start: Math.max(+start, 0),\r\n        end: Math.min(+end + 1, text.length)\r\n      });\r\n    }\r\n  }\r\n\r\n  let channelEmotes = useContext(EmotesContext);\r\n  let idx = -1;\r\n  let nextIdx = 0;\r\n  do {\r\n    nextIdx = text.indexOf(' ', idx + 1);\r\n    if (nextIdx === -1) {\r\n      nextIdx = text.length;\r\n    }\r\n\r\n    let name = text.slice(idx + 1, nextIdx);\r\n    let emote = channelEmotes.get(name);\r\n    if (emote) {      \r\n      emotes.push({\r\n        id: name,\r\n        urls: emote,\r\n        start: Math.max(idx + 1, 0),\r\n        end: Math.min(nextIdx, text.length)\r\n      });\r\n    }\r\n  } while ((idx = text.indexOf(' ', nextIdx)) !== -1);\r\n\r\n  emotes.sort((x, y) => x.start - y.start);\r\n\r\n  let index = 0;\r\n  let content: Array<string | Emote> = [];\r\n  for (const emote of emotes) {\r\n    content.push(text.slice(index, emote.start));\r\n    content.push({\r\n      id: emote.id,\r\n      urls: emote.urls,\r\n      key: `${emote.start}-${emote.end}`\r\n    });\r\n    index = emote.end;\r\n  }\r\n\r\n  content.push(text.substr(index, text.length - index));  \r\n\r\n  let config = useContext(ConfigContext);\r\n  let emoteScale = Math.max(1, Math.min(4, Math.round(config!.fontSize / 15)))\r\n  let elements: Array<any> = [];\r\n  for (const item of content) {\r\n    if (typeof item === 'string') {\r\n      elements.push(item);\r\n      continue;\r\n    }\r\n\r\n    let emote = item as Emote;\r\n    elements.push(<img className={\"emote emote-scale-\" + emoteScale} key={(item.id + \"-\" + item.key)} alt={item.id} src={emote.urls[0]} srcSet={createEmoteSrcSet(emote.urls)} />);\r\n  }\r\n\r\n  return (\r\n    <span className={\"message-content \" + (isMe ? \"me\" : \"\")}>{elements}</span>\r\n  );\r\n}","import React, { useContext } from 'react';\r\nimport { ConfigContext, PronounsContext } from \"./Contexts\";\r\n\r\ninterface PronounsProps {\r\n    nick: string;\r\n}\r\n\r\nexport const Pronouns = (props: PronounsProps) => {\r\n    const configContext = useContext(ConfigContext);\r\n    const pronounsContext = useContext(PronounsContext);\r\n    if(!configContext?.showPronouns) return null;\r\n\r\n    let display = \"\";\r\n    let pronouns = pronounsContext?.userMap.get(props.nick);\r\n    if (!pronouns) pronounsContext?.fetchPronouns(props.nick);\r\n    else {\r\n        display = pronounsContext?.displayMap.get(pronouns.pronoun) ?? \"\";\r\n    }\r\n\r\n    return (display ? <span className=\"pronouns\">{display}</span> : null);\r\n}\r\n","import React, { Component } from 'react';\r\nimport { TwitchDefaultColors } from './Constants';\r\nimport { Badges } from \"./Badges\"\r\nimport { Content } from \"./Content\"\r\nimport { Pronouns } from './Pronouns';\r\nimport { ColorContext, ConfigContext } from \"./Contexts\";\r\nimport { ChatMessage, Configuration } from './Types';\r\n\r\ninterface MessageProps {\r\n  message: ChatMessage;\r\n}\r\ninterface MessageState {\r\n  timeout: number | NodeJS.Timeout;\r\n  hidden: boolean;\r\n}\r\n\r\n// export const Message = (props: MessageProps) => {\r\n// }\r\n\r\nexport class Message extends Component<MessageProps, MessageState> {\r\n\r\n  static contextType = ConfigContext;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { hidden: false, timeout: 0 };\r\n  }\r\n\r\n  componentDidMount() {\r\n    let config = this.context as Configuration;\r\n    if (config.hideMessages) {\r\n      this.setState({ timeout: setTimeout(() => console.log(this.setState({ hidden: true })), config.hideMessagesTimeout) })\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.state.timeout) {\r\n      clearTimeout(this.state.timeout as number);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <ConfigContext.Consumer>\r\n        {(config =>\r\n          <ColorContext.Consumer>\r\n            {(adjuster => {\r\n              let message = this.props.message;\r\n              let rawNick = message.authorName.toLowerCase();\r\n\r\n              if (config?.blockedUsers.includes(rawNick!.toLowerCase())) { return null; }\r\n              if (config?.hideCommands && message.content.startsWith('!')) { return null; }\r\n\r\n              let nick = message.authorDisplayName ?? rawNick;\r\n              let color: string = \"inherit\";\r\n\r\n              if (config?.showUserColours) {\r\n                color = adjuster.process(!message.authorColour ? TwitchDefaultColors[nick.toLowerCase().charCodeAt(0) % 15] : message.authorColour);\r\n              }\r\n\r\n              return (\r\n                <p className={\"message\" + (this.state.hidden ? \" hidden\" : \"\")}>\r\n                  <Badges badges={message.rawBadges} />\r\n                  <Pronouns nick={rawNick!} />\r\n                  <span className=\"nick\" style={{ color }}>{nick}</span>\r\n                  <Content text={message.content} emotes={message.rawEmotes} me={message.type === \"action\"} />\r\n                </p>\r\n              );\r\n            })}\r\n          </ColorContext.Consumer>\r\n        )}\r\n      </ConfigContext.Consumer>\r\n    )\r\n\r\n  }\r\n}","import { fetchJSON } from \"../Utils\";\r\n\r\nexport interface FFZEmote {\r\n    id: number;\r\n    code: string;\r\n    images: FFZEmoteImages;\r\n  }\r\n  \r\n  export interface FFZEmoteImages {\r\n    \"1x\": string\r\n    \"2x\": string\r\n    \"4x\": string\r\n  }\r\n\r\nexport class FFZ {\r\n    static async fetchGlobalEmotes(): Promise<FFZEmote[]> {\r\n        return await fetchJSON(`https://api.betterttv.net/3/cached/frankerfacez/emotes/global`)\r\n    }\r\n    static async fetchChannelEmotes(id: string): Promise<FFZEmote[]> {\r\n        return await fetchJSON(`https://api.betterttv.net/3/cached/frankerfacez/users/twitch/${id}`)\r\n    }\r\n}","import { fetchJSON } from \"../Utils\";\r\n\r\nexport interface BTTVUser {\r\n    id: number\r\n    channelEmotes: BTTVEmote[],\r\n    sharedEmotes: BTTVEmote[]\r\n}\r\n\r\nexport interface BTTVEmote {\r\n    id: string,\r\n    code: string,\r\n}\r\n\r\nexport class BTTV {\r\n    static async fetchGlobalEmotes(): Promise<BTTVEmote[]> {\r\n        return await fetchJSON(`https://api.betterttv.net/3/cached/emotes/global`)\r\n    }\r\n    static async fetchUser(id: string): Promise<BTTVUser> {\r\n        return await fetchJSON(`https://api.betterttv.net/3/cached/users/twitch/${id}`)\r\n    }\r\n}","import { fetchJSON } from \"../Utils\"\r\n\r\nexport interface SevenTVEmote {\r\n    id: string,\r\n    name: string,\r\n    urls: string[][]\r\n}\r\n\r\nexport class SevenTV {\r\n    static async fetchGlobalEmotes(): Promise<SevenTVEmote[]> {\r\n        return await fetchJSON(`https://api.7tv.app/v2/emotes/global`)\r\n    }\r\n    static async fetchChannelEmotes(id: string): Promise<SevenTVEmote[]> {\r\n        return await fetchJSON(`https://api.7tv.app/v2/users/${id}/emotes`)\r\n    }\r\n}","import { Component } from 'react';\r\nimport { Message } from \"./Message\"\r\nimport { Cheer, Configuration, EmoteEventUpdate, ChatMessage } from \"./Types\"\r\nimport { fetchJSON } from \"./Utils\"\r\nimport { ColorAdjuster } from './Color';\r\nimport { ConfigContext, ColorContext, BadgesContext, EmotesContext, PronounsContext } from './Contexts';\r\nimport { TwitchApi } from './api/Twitch';\r\nimport { ClientId } from './ClientId';\r\nimport { Client as TMIClient, Userstate } from \"tmi.js\"\r\nimport './Chat.css';\r\nimport { FFZ } from './api/FFZ';\r\nimport { BTTV } from './api/BTTV';\r\nimport { SevenTV } from './api/7TV';\r\n\r\ninterface ChatState {\r\n  connected: boolean;\r\n  messages: Array<ChatMessage>\r\n  badges: Map<string, string[][]>;\r\n  emotes: Map<string, string[]>;\r\n  cheers: Map<string, Cheer>;\r\n  colorAdjuster: ColorAdjuster;\r\n\r\n  tmiClient?: TMIClient;\r\n  twitchApi?: TwitchApi;\r\n\r\n  pronounDisplay: Map<string, string>;\r\n  pronounUsers: Map<string, Pronoun>;\r\n\r\n  channelId?: string;\r\n  channelName?: string;\r\n  sevenTvEvents?: EventSource;\r\n\r\n  errorMessage?: string;\r\n}\r\n\r\ninterface Pronoun {\r\n  pending: boolean;\r\n  pronoun: string;\r\n}\r\n\r\nexport interface Pronouns {\r\n  displayMap: Map<string, string>;\r\n  userMap: Map<string, Pronoun>;\r\n  fetchPronouns: (nick: string) => void;\r\n}\r\n\r\nexport class Chat extends Component<Configuration, ChatState> {\r\n  constructor(props: Configuration) {\r\n    super(props);\r\n    let state: ChatState = {\r\n      connected: false,\r\n      messages: [],\r\n      badges: new Map(),\r\n      emotes: new Map(),\r\n      cheers: new Map(),\r\n      pronounUsers: new Map(),\r\n      pronounDisplay: new Map(),\r\n      colorAdjuster: new ColorAdjuster()\r\n    };\r\n    this.state = state;\r\n  }\r\n\r\n  async componentDidMount() {\r\n    await this.load();\r\n  }\r\n\r\n  async componentDidUpdate(previousProps: Configuration) {\r\n    if (this.props.accessToken !== previousProps.accessToken) {\r\n      await this.load();\r\n    }\r\n\r\n    if (this.props.readableColours !== previousProps.readableColours ||\r\n      this.props.readableContrast !== previousProps.readableContrast ||\r\n      this.props.readableBackground !== previousProps.readableBackground ||\r\n      this.props.readableMode !== previousProps.readableMode) {\r\n      this.setState({ colorAdjuster: new ColorAdjuster(this.props.readableBackground, (!this.props.readableColours ? 0 : this.props.readableMode), this.props.readableContrast) });\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.cleanup();\r\n  }\r\n\r\n  async load() {\r\n    this.cleanup();\r\n\r\n    if (!this.props.accessToken) {\r\n      this.setState({ errorMessage: \"No channel specifed!\" });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      let twitchApi = new TwitchApi(ClientId, this.props.accessToken);\r\n      let users = await twitchApi.getUsers();\r\n      if (!users || !users.length) {\r\n        this.setState({ errorMessage: \"Specified channel doesn't exist!\" });\r\n        return;\r\n      }\r\n\r\n      this.setState({ channelId: users[0].id, channelName: users[0].login, twitchApi: twitchApi });\r\n      this.connect();\r\n    } catch (error) {\r\n      // BUGBUG this is terrible\r\n      localStorage.removeItem(\"access_token\");\r\n      window.location.reload();\r\n      return;\r\n    }\r\n\r\n    let encodedId = encodeURIComponent(this.state.channelId!);\r\n    await Promise.all([this.loadBadges(encodedId), this.loadEmotes(encodedId), this.loadCheers(encodedId), this.loadPronouns()]);\r\n  }\r\n\r\n  private cleanup() {\r\n    let events = this.state.sevenTvEvents;\r\n    let tmiClient = this.state.tmiClient;\r\n\r\n    this.setState({\r\n      errorMessage: undefined,\r\n      messages: [],\r\n      colorAdjuster: new ColorAdjuster(this.props.readableBackground, this.props.readableMode, this.props.readableContrast),\r\n      sevenTvEvents: undefined,\r\n      tmiClient: undefined,\r\n      emotes: new Map(),\r\n      badges: new Map(),\r\n      pronounUsers: new Map(),\r\n      pronounDisplay: new Map(),\r\n      connected: false\r\n    });\r\n\r\n    if (tmiClient) {\r\n      tmiClient.disconnect();\r\n    }\r\n\r\n    if (events) {\r\n      events.close();\r\n    }\r\n  }\r\n\r\n  private connect() {\r\n    let client = new TMIClient({\r\n      options: { debug: true, clientId: ClientId, skipUpdatingEmotesets: true },\r\n      identity: { username: this.state.channelName!, password: this.props.accessToken },\r\n      channels: [this.state.channelName!]\r\n    });\r\n\r\n    client.addListener(\"message\", this.onMessage.bind(this));\r\n    // TODO:\r\n    // client.addListener(\"messagedeleted\")\r\n    // client.addListener(\"clearchat\")\r\n    client.connect();\r\n\r\n    this.setState({ tmiClient: client });\r\n  }\r\n\r\n  onMessage(channel: string, userstate: Userstate, message: string, self: boolean) {\r\n    console.log(userstate);\r\n    let chatMessage: ChatMessage = {\r\n      id: userstate.id!,\r\n      content: message,\r\n      type: userstate['message-type'] as string,\r\n      authorName: userstate.username,\r\n      authorDisplayName: userstate['display-name'],\r\n      authorColour: userstate.color,\r\n      rawBadges: userstate['badges-raw'],\r\n      rawEmotes: userstate['emotes-raw']\r\n    }\r\n\r\n    if (chatMessage.type === \"action\" || chatMessage.type === \"chat\")\r\n      this.setState(oldState => ({ messages: [...(oldState.messages.length >= 50 ? oldState.messages.slice(1, 50) : oldState.messages), chatMessage] }));\r\n  }\r\n\r\n  private async loadBadges(encodedId: string) {\r\n    if (!!!this.state.twitchApi) return;\r\n\r\n    let badgeSets = await Promise.all([ // TODO: FFZ custom badges\r\n      this.state.twitchApi.getGlobalBadges(),\r\n      this.state.twitchApi.getUserBadges(encodedId)\r\n    ]);\r\n\r\n    let badges = new Map<string, string[][]>();\r\n    for (const badgeSetList of badgeSets) {\r\n      for (const badgeSet of badgeSetList) {\r\n        let badgeName = badgeSet.set_id;\r\n        let badgeVersions: string[][] = [];\r\n        for (const badgeVersion in badgeSet.versions) {\r\n          badgeVersions.push([\r\n            badgeSet.versions[badgeVersion].image_url_1x,\r\n            badgeSet.versions[badgeVersion].image_url_2x,\r\n            badgeSet.versions[badgeVersion].image_url_4x,\r\n          ]);\r\n        }\r\n\r\n        badges.set(badgeName, badgeVersions);\r\n      }\r\n    }\r\n\r\n    console.log(\"Loaded badges\", badges);\r\n    this.setState({ badges });\r\n  }\r\n\r\n  private async loadCheers(encodedId: string) {\r\n    //let cheers = await fetchTwitch(`https://api.twitch.tv/helix/bits/cheermotes?channel_id=${encodedId}`)\r\n    // for (const action of cheers.actions) {\r\n    //   let cheer: Cheer = { prefixes: new Map() }\r\n    //   for (const tier of action.tiers) {\r\n\r\n    //   }\r\n    // }\r\n  }\r\n\r\n  private async loadEmotes(encodedId: string) {\r\n    let emotes = new Map<string, string[]>();\r\n\r\n    let ffzEmotes = await FFZ.fetchGlobalEmotes();\r\n    ffzEmotes.push(...await FFZ.fetchChannelEmotes(encodedId))\r\n    for (const emote of ffzEmotes) {\r\n      emotes.set(emote.code, [emote.images['1x'], emote.images['2x'], emote.images['4x']])\r\n    }\r\n\r\n    let bttvUser = await BTTV.fetchUser(encodedId);\r\n    let bttvEmotes = await BTTV.fetchGlobalEmotes();\r\n    bttvEmotes.push(...bttvUser.channelEmotes);\r\n    bttvEmotes.push(...bttvUser.sharedEmotes);\r\n\r\n    for (const emote of bttvEmotes) {\r\n      emotes.set(emote.code, [\r\n        `https://cdn.betterttv.net/emote/${emote.id}/1x`,\r\n        `https://cdn.betterttv.net/emote/${emote.id}/2x`,\r\n        `https://cdn.betterttv.net/emote/${emote.id}/3x`\r\n      ]);\r\n    }\r\n\r\n    let sevenTVEmotes = await SevenTV.fetchGlobalEmotes();\r\n    sevenTVEmotes.push(...await SevenTV.fetchChannelEmotes(encodedId));\r\n    for (const emote of sevenTVEmotes) {\r\n      emotes.set(emote.name, emote.urls.map(e => e[1]));\r\n    }\r\n\r\n    this.sevenTVSubscribe();\r\n\r\n    console.log(\"Loaded emotes\", emotes);\r\n    this.setState({ emotes });\r\n  }\r\n\r\n  private async sevenTVSubscribe() {\r\n    let eventSource = new EventSource(`https://events.7tv.app/v1/channel-emotes?channel=${this.state.channelName!}`);\r\n\r\n    eventSource.addEventListener('ready', (ev: Event) => {\r\n      let message = ev as MessageEvent; // this is stupid lol\r\n      console.log(`7TV ready, ${message.data}`);\r\n    })\r\n\r\n    eventSource.addEventListener('update', (ev: Event) => {\r\n      let message = ev as MessageEvent; // this is stupid lol\r\n      let eventUpdate = JSON.parse(message.data) as EmoteEventUpdate;\r\n      if (eventUpdate === undefined) return;\r\n\r\n      let emotes = new Map<string, string[]>(this.state.emotes);\r\n\r\n      if (eventUpdate.action === \"ADD\") {\r\n        emotes.set(eventUpdate.name, [\r\n          `https://cdn.7tv.app/emote/${eventUpdate.emote_id}/1x`,\r\n          `https://cdn.7tv.app/emote/${eventUpdate.emote_id}/2x`,\r\n          `https://cdn.7tv.app/emote/${eventUpdate.emote_id}/3x`,\r\n        ]);\r\n\r\n        console.log(`7TV emotes: added ${eventUpdate.name}!`)\r\n      }\r\n      else if (eventUpdate.action === \"REMOVE\") {\r\n        emotes.delete(eventUpdate.name);\r\n        console.log(`7TV emotes: removed ${eventUpdate.name}!`)\r\n      }\r\n\r\n      this.setState({ emotes });\r\n    })\r\n\r\n    this.setState({ sevenTvEvents: eventSource });\r\n  }\r\n\r\n  private async loadPronouns() {\r\n    let pronouns = new Map<string, string>();\r\n    let pronounsJson = await fetchJSON(\"https://pronouns.alejo.io/api/pronouns\");\r\n    for (const value of pronounsJson) {\r\n      pronouns.set(value.name, value.display);\r\n    }\r\n\r\n    this.setState({ pronounDisplay: pronouns });\r\n  }\r\n\r\n  private async fetchPronouns(userName: string) {\r\n    if (this.state.pronounUsers.has(userName)) return;\r\n    this.state.pronounUsers.set(userName, { pending: true, pronoun: \"\" });\r\n\r\n    let json = await fetchJSON(`https://pronouns.alejo.io/api/users/${userName}`);\r\n    if (!Array.isArray(json)) return;\r\n\r\n    this.state.pronounUsers.set(userName, { pending: false, pronoun: json[0]?.pronoun_id });\r\n    this.setState({ pronounUsers: this.state.pronounUsers });\r\n  }\r\n\r\n  render() {\r\n    let style = {\r\n      color: this.props.fontColor ?? \"white\",\r\n      fill: this.props.fontColor ?? \"white\",\r\n      fontFamily: this.props.fontName,\r\n      fontSize: this.props.fontSize + \"pt\",\r\n      fontWeight: this.props.fontWeight,\r\n      filter: \"\",\r\n      WebkitTextStroke: \"\",\r\n      stroke: \"\",\r\n      strokeWidth: \"\",\r\n    }\r\n\r\n    if (this.props.dropShadow) {\r\n      style.filter = style.filter + `drop-shadow(${this.props.dropShadowOffset}px ${this.props.dropShadowOffset}px ${this.props.dropShadowBlur}px ${this.props.dropShadowColour})`\r\n    }\r\n\r\n    if (this.props.outline) {\r\n      style.WebkitTextStroke = `${this.props.outlineThickness}px ${this.props.outlineColour}`\r\n      style.stroke = this.props.outlineColour!\r\n      style.strokeWidth = `${this.props.outlineThickness! * 7.5}px`\r\n    }\r\n\r\n    if (this.state.errorMessage) {\r\n      return (\r\n        <div className=\"chat-container\" style={style}>\r\n          <div className=\"chat-error\">\r\n            <svg height=\"128px\" viewBox=\"0 0 960 960\" width=\"128px\" xmlns=\"http://www.w3.org/2000/svg\" xmlnsXlink=\"http://www.w3.org/1999/xlink\">\r\n              <path d=\"M0,480C0,435.667 5.66667,393.083 17,352.25C28.3333,311.417 44.4167,273.167 65.25,237.5C86.0833,201.833 111.083,169.417 140.25,140.25C169.417,111.083 201.833,86.0834 237.5,65.25C273.167,44.4167 311.417,28.3334 352.25,17C393.083,5.66669 435.667,0 480,0C524,0 566.417,5.75 607.25,17.25C648.083,28.75 686.333,44.9167 722,65.75C757.667,86.5834 790.083,111.583 819.25,140.75C848.417,169.917 873.417,202.333 894.25,238C915.083,273.667 931.25,311.917 942.75,352.75C954.25,393.583 960,436 960,480C960,524.333 954.333,566.917 943,607.75C931.667,648.583 915.583,686.833 894.75,722.5C873.917,758.167 848.917,790.583 819.75,819.75C790.583,848.917 758.167,873.917 722.5,894.75C686.833,915.583 648.583,931.667 607.75,943C566.917,954.333 524.333,960 480,960C435.667,960 393,954.333 352,943C311,931.667 272.75,915.583 237.25,894.75C201.75,873.917 169.417,848.917 140.25,819.75C111.083,790.583 86.0833,758.25 65.25,722.75C44.4167,687.25 28.3333,649 17,608C5.66667,567 0,524.333 0,480ZM896,480C896,441.667 891.083,404.75 881.25,369.25C871.417,333.75 857.417,300.583 839.25,269.75C821.083,238.917 799.417,210.917 774.25,185.75C749.083,160.583 721.083,138.917 690.25,120.75C659.417,102.583 626.25,88.5834 590.75,78.75C555.25,68.9167 518.333,64.0001 480,64C441.667,64.0001 404.75,68.9167 369.25,78.75C333.75,88.5834 300.583,102.5 269.75,120.5C238.917,138.5 210.833,160.167 185.5,185.5C160.167,210.833 138.5,238.917 120.5,269.75C102.5,300.583 88.5833,333.75 78.75,369.25C68.9167,404.75 64,441.667 64,480C64,518.333 68.9167,555.25 78.75,590.75C88.5833,626.25 102.5,659.417 120.5,690.25C138.5,721.083 160.167,749.167 185.5,774.5C210.833,799.833 238.917,821.5 269.75,839.5C300.583,857.5 333.75,871.417 369.25,881.25C404.75,891.083 441.667,896 480,896C518.333,896 555.25,891.083 590.75,881.25C626.25,871.417 659.417,857.417 690.25,839.25C721.083,821.083 749.083,799.417 774.25,774.25C799.417,749.083 821.083,721.083 839.25,690.25C857.417,659.417 871.417,626.25 881.25,590.75C891.083,555.25 896,518.333 896,480ZM448,544L448,288C448,279.333 451.167,271.833 457.5,265.5C463.833,259.167 471.333,256 480,256C488.667,256 496.167,259.167 502.5,265.5C508.833,271.833 512,279.333 512,288L512,544C512,552.667 508.833,560.167 502.5,566.5C496.167,572.833 488.667,576 480,576C471.333,576 463.833,572.833 457.5,566.5C451.167,560.167 448,552.667 448,544ZM432,672C432,658.667 436.667,647.333 446,638C455.333,628.667 466.667,624 480,624C493.333,624 504.667,628.667 514,638C523.333,647.333 528,658.667 528,672C528,685.333 523.333,696.667 514,706C504.667,715.333 493.333,720 480,720C466.667,720 455.333,715.333 446,706C436.667,696.667 432,685.333 432,672Z\" />\r\n            </svg>\r\n            <p>{this.state.errorMessage}</p>\r\n          </div>\r\n        </div>\r\n      )\r\n    }\r\n    return (\r\n      <div className=\"chat-container\">\r\n        <div className=\"chat-root\" style={style}>\r\n          <ConfigContext.Provider value={this.props}>\r\n            <ColorContext.Provider value={this.state.colorAdjuster}>\r\n              <BadgesContext.Provider value={this.state.badges}>\r\n                <EmotesContext.Provider value={this.state.emotes}>\r\n                  <PronounsContext.Provider value={{ userMap: this.state.pronounUsers, displayMap: this.state.pronounDisplay, fetchPronouns: this.fetchPronouns.bind(this) }}>\r\n                    {this.state.messages.map(m => <Message key={m.id} message={m} />)}\r\n                  </PronounsContext.Provider>\r\n                </EmotesContext.Provider>\r\n              </BadgesContext.Provider>\r\n            </ColorContext.Provider>\r\n          </ConfigContext.Provider>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}","\r\nimport React from \"react\";\r\nimport { Chat } from \"./Chat\";\r\nimport { Configurator } from \"./Configurator\";\r\nimport { Configuration } from \"./Types\";\r\nimport { decode } from \"@msgpack/msgpack\"\r\nimport { DefaultConfig } from \"./Constants\";\r\nimport { ApiError } from \"./ApiError\";\r\nimport \"./colors.css\"\r\n\r\nexport const App = () => {\r\n  let config: Configuration = DefaultConfig;\r\n  try {\r\n    let newConfig = decode(Buffer.from(window.location.hash.substring(1), 'base64')) as Partial<Configuration>;\r\n    console.log(config, newConfig);\r\n    config = Object.assign(config, newConfig);\r\n  }\r\n  catch (e) { }\r\n\r\n  // return (\r\n  //   !!config.accessToken ? <Chat {...config as Configuration} /> : <Configurator />\r\n  // );\r\n\r\n  if(!!config.accessToken) {\r\n    return <Chat {...config as Configuration} />\r\n  }\r\n  else if(!!config.channelName) {\r\n    return <ApiError/>\r\n  }\r\n\r\n  return <Configurator />;\r\n};","import \"./config.css\"\r\n\r\nimport * as MsgPack from \"@msgpack/msgpack\"\r\n\r\nimport { ClientId, Scopes } from './ClientId';\r\nimport React, { ChangeEvent, Component } from 'react';\r\n\r\nimport { Chat } from './Chat';\r\nimport { Configuration } from './Types';\r\nimport { DefaultConfig } from './Constants';\r\nimport { TwitchApi } from './api/Twitch';\r\n\r\ntype FontData = {\r\n  family: string,\r\n}\r\n\r\ndeclare global {\r\n  interface Window {\r\n    queryLocalFonts: () => Promise<FontData[]>\r\n  }\r\n}\r\n\r\ninterface ConfiguratorState {\r\n  connecting: boolean;\r\n  config: Configuration;\r\n  chatConfig?: Configuration;\r\n  window: Window | null;\r\n  fonts: FontData[]\r\n}\r\n\r\n\r\nconst Checkbox = (props: { label: string, value: boolean, onChange: (event: ChangeEvent<HTMLInputElement>) => void }) => {\r\n  return (\r\n    <label className=\"checkbox\">\r\n      <input type=\"checkbox\"\r\n        checked={props.value}\r\n        onChange={props.onChange} />\r\n      <span className=\"checkmark\"></span> {props.label}\r\n    </label>\r\n  )\r\n}\r\n\r\n\r\nexport class Configurator extends Component<{}, ConfiguratorState> {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = { connecting: true, config: DefaultConfig, chatConfig: DefaultConfig, window: null, fonts: [] };\r\n    this.onWindowMessage = this.onWindowMessage.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    let token = localStorage.getItem(\"access_token\");\r\n    if (token != null) {\r\n      this.validateToken(token);\r\n    }\r\n    else {\r\n      this.setState({ connecting: false });\r\n    }\r\n\r\n    if ('queryLocalFonts' in window) {\r\n      window.queryLocalFonts().then((fonts: FontData[]) => {\r\n        this.setState({ fonts: fonts.filter((f, i, a) => a.findIndex(o => o.family == f.family) === i) });\r\n      });\r\n    }\r\n  }\r\n\r\n  async validateToken(token: string) {\r\n    try {\r\n      await new TwitchApi(ClientId, token).getUsers([\"wamwoowam\"]);\r\n\r\n      this.onValueChange(\"accessToken\", token);\r\n      localStorage.setItem(\"access_token\", token);\r\n      this.setState({ connecting: false });\r\n    }\r\n    catch (e) {\r\n      // we dont have a valid token, kick back to the login screen\r\n    }\r\n  }\r\n\r\n  updateChat() {\r\n    this.setState({ chatConfig: this.state.config });\r\n  }\r\n\r\n  onValueChange<T>(name: string, newValue: T) {\r\n    if (this.state[name] !== newValue)\r\n      this.setState({ config: { ...this.state.config, [name]: newValue }, chatConfig: { ...this.state.config, [name]: newValue } });\r\n  }\r\n\r\n  showOAuthWindow() {\r\n    if (this.state.window !== null && !this.state.window.closed) {\r\n      this.state.window.focus();\r\n      return;\r\n    }\r\n\r\n    window.addEventListener(\"message\", this.onWindowMessage);\r\n\r\n    let redirectUrl = `${window.location.origin}/chatbox-v2/auth.html`\r\n    let wnd = window.open(\r\n      `https://id.twitch.tv/oauth2/authorize?client_id=${ClientId}&redirect_uri=${redirectUrl}&response_type=token&scope=${Scopes}`,\r\n      \"sign in\",\r\n      \"toolbar=no, menubar=no, width=600, height=700\")\r\n\r\n    if (wnd != null) {\r\n      this.setState({ window: wnd });\r\n    }\r\n  }\r\n\r\n  onWindowMessage(event: MessageEvent) {\r\n    if (typeof event.data !== 'string') return;\r\n    if (event.origin !== window.location.origin) return;\r\n\r\n    window.removeEventListener(\"message\", this.onWindowMessage);\r\n    let queryParams = new URLSearchParams(event.data.substring(1));\r\n    let accessToken = queryParams.get(\"access_token\");\r\n    if (accessToken != null) {\r\n      this.validateToken(accessToken);\r\n    }\r\n  }\r\n\r\n  showHelpDialog() {\r\n\r\n  }\r\n\r\n  onSubmit(e) {\r\n    e.preventDefault();\r\n  }\r\n\r\n  render() {\r\n    let configDiff = {};\r\n    for (const key in this.state.config) {\r\n      const element = this.state.config[key];\r\n      const element2 = DefaultConfig[key];\r\n      if (element !== element2) {\r\n        configDiff[key] = element;\r\n      }\r\n    }\r\n\r\n    let configString = btoa(String.fromCharCode(...MsgPack.encode(configDiff)));\r\n\r\n    return (\r\n      <>\r\n        <div className=\"config-background\" />\r\n        <div className=\"config-root dark\">\r\n          <div className=\"config-pane\">\r\n            <div className=\"config-main\">\r\n              <form onSubmit={this.onSubmit.bind(this)} className=\"config-input\">\r\n                <h1>Wam's Chat Thing</h1>\r\n                <h4>A simple, easy to use chat box that supports <a href=\"https://betterttv.net/\">BetterTTV</a>, <a href=\"https://frankerfacez.com/\">FrankerFaceZ</a> and <a href=\"https://7tv.app/\">7tv</a> emotes!</h4>\r\n\r\n                <div className=\"config-warning\">\r\n                  <p>This chat box is not yet finished so links may break in future! Please don't use it in your layouts yet.</p>\r\n                </div>\r\n\r\n                {\r\n                  this.state.connecting ?\r\n                    <p>Loading...</p> :\r\n                    <>\r\n                      {this.state.config.accessToken ? null : (this.renderSignInButton())}\r\n                      {this.state.config.accessToken ? (this.renderConfigSection()) : null}\r\n                    </>\r\n                }\r\n\r\n              </form>\r\n\r\n              {this.state.config.accessToken ?\r\n                (<div className=\"config-footer\">\r\n                  <p>Paste this into a browser source!</p>\r\n                  <input className=\"config-input-text\" readOnly={true} value={`${window.location.href}#${configString}`} />\r\n                </div>) : null}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"config-example\">\r\n            <Chat {...this.state.chatConfig!} />\r\n          </div>\r\n        </div>\r\n      </>\r\n    )\r\n  }\r\n\r\n  renderSignInButton() {\r\n    return (<>\r\n      <div className=\"config-error\">\r\n        <p>Sorry! Because the legacy Twitch API has been deprecated and is in the process of being decommissioned and limitations of the new API, you will now need to Sign in with Twitch to use this chatbox. You can read more about this <a href=\"https://blog.twitch.tv/en/2021/07/15/legacy-twitch-api-v5-shutdown-details-and-timeline/\">on their blog</a>.</p>\r\n      </div>\r\n      <button className=\"btn btn-accent\"\r\n        style={{ margin: \"1em 0\" }}\r\n        onClick={this.showOAuthWindow.bind(this)}>\r\n        Sign in with Twitch\r\n      </button>\r\n    </>);\r\n  }\r\n\r\n  renderConfigSection() {\r\n    return (<>\r\n      <div className=\"form-group-label form-group-font\">\r\n        <label className=\"form-group-font-label\">Font</label>\r\n        {/* <button className=\"form-group-font-help\" onClick={this.showHelpDialog.bind(this)}>Help!</button> */}\r\n      </div>\r\n      <div className=\"form-group\">\r\n        {this.state.fonts.length ?\r\n          <select className=\"config-input-text\" style={{ flex: 3 }} value={this.state.config.fontName} onChange={(e) => this.onValueChange(\"fontName\", e.target.value)}>\r\n            {this.state.fonts.map((font) => <option value={font.family}>{font.family}</option>)}\r\n          </select>\r\n          : <input type=\"text\"\r\n            className=\"config-input-text\"\r\n            placeholder=\"Font Name\"\r\n            size={1}\r\n            style={{ flex: 3 }}\r\n            value={this.state.config.fontName}\r\n            onChange={(e) => this.onValueChange(\"fontName\", e.target.value)} />\r\n        }\r\n\r\n        <input type=\"text\"\r\n          className=\"config-input-text config-input-number\"\r\n          placeholder=\"Font Size\"\r\n          size={1}\r\n          value={this.state.config.fontSize}\r\n          onChange={(e) => this.onValueChange(\"fontSize\", isNaN(+e.target.value) ? this.state.config.fontSize : +e.target.value)} />\r\n\r\n        <select title=\"font weight\" className=\"config-input-text\"\r\n          value={this.state.config.fontWeight}\r\n          onChange={(e) => this.onValueChange(\"fontWeight\", +e.target.value)}>\r\n          <option value=\"100\">Thin</option>\r\n          <option value=\"200\">Light</option>\r\n          <option value=\"300\">Semilight</option>\r\n          <option value=\"400\">Regular</option>\r\n          <option value=\"500\">Semibold</option>\r\n          <option value=\"600\">Bold</option>\r\n          <option value=\"700\">Extra Bold</option>\r\n          <option value=\"800\">Black</option>\r\n          <option value=\"900\">Ultra Black</option>\r\n        </select>\r\n\r\n        <input title=\"font color\" type=\"color\"\r\n          className=\"config-input-text\"\r\n          size={1}\r\n          value={this.state.config.fontColor}\r\n          onChange={(e) => this.onValueChange(\"fontColor\", e.target.value)} />\r\n      </div>\r\n\r\n      <label className=\"form-group-label\">\r\n        Ignored users (one per line)\r\n      </label>\r\n      <div className=\"form-group\">\r\n        <textarea title=\"blocked users\" className=\"config-input-text\"\r\n          value={this.state.config.blockedUsers.join('\\n')}\r\n          onChange={(e) => this.onValueChange(\"blockedUsers\", e.target.value.split('\\n'))} />\r\n      </div>\r\n\r\n      <div className=\"form-group\">\r\n        <Checkbox label=\"Show badges\" value={this.state.config.showBadges} onChange={(e) => this.onValueChange(\"showBadges\", e.target.checked)} />\r\n        <Checkbox label=\"Show pronouns\" value={this.state.config.showPronouns} onChange={(e) => this.onValueChange(\"showPronouns\", e.target.checked)} />\r\n        <Checkbox label=\"Show user colours\" value={this.state.config.showUserColours} onChange={(e) => this.onValueChange(\"showUserColours\", e.target.checked)} />\r\n\r\n        {\r\n          this.state.config.showUserColours ?\r\n            <Checkbox label=\"Readable colours\" value={this.state.config.readableColours} onChange={(e) => this.onValueChange(\"readableColours\", e.target.checked)} /> : null\r\n        }\r\n\r\n        <Checkbox label=\"Hide commands\" value={this.state.config.hideCommands} onChange={(e) => this.onValueChange(\"hideCommands\", e.target.checked)} />\r\n        <Checkbox label=\"Temporary messages\" value={this.state.config.hideMessages} onChange={(e) => this.onValueChange(\"hideMessages\", e.target.checked)} />\r\n        <Checkbox label=\"Drop shadow\" value={this.state.config.dropShadow} onChange={(e) => this.onValueChange(\"dropShadow\", e.target.checked)} />\r\n        <Checkbox label=\"Outline\" value={this.state.config.outline} onChange={(e) => this.onValueChange(\"outline\", e.target.checked)} />\r\n      </div>\r\n\r\n      {this.state.config.hideMessages ? (\r\n        <>\r\n          <h4 className=\"form-group-header\">Temporary Messages</h4>\r\n\r\n          <div className=\"form-group\">\r\n            <label className=\"form-label\">\r\n              Message Timeout (seconds)\r\n              <input type=\"number\"\r\n                className=\"config-input-text config-input-number\"\r\n                placeholder=\"Message Timeout\"\r\n                size={1}\r\n                defaultValue={this.state.config.hideMessagesTimeout / 1000}\r\n                onBlur={(e) => this.onValueChange(\"hideMessagesTimeout\", isNaN(+e.target.value) ? this.state.config.hideMessagesTimeout : +e.target.value * 1000)} />\r\n            </label>\r\n          </div>\r\n        </>\r\n      ) : null}\r\n\r\n      {this.state.config.showUserColours && this.state.config.readableColours ? (\r\n        <>\r\n          <h4 className=\"form-group-header\">Readable Colour Options</h4>\r\n\r\n          <div className=\"form-group\">\r\n            <label className=\"form-label\">\r\n              Target Contrast\r\n              <input type=\"range\"\r\n                min={0}\r\n                max={10}\r\n                step={0.5}\r\n                value={this.state.config.readableContrast}\r\n                onChange={(e) => this.onValueChange(\"readableContrast\", +e.target.value)} />\r\n            </label>\r\n\r\n            <label className=\"form-label\">\r\n              Background Colour\r\n              <input type=\"color\"\r\n                className=\"config-input-text\"\r\n                size={1}\r\n                value={this.state.config.readableBackground}\r\n                onChange={(e) => this.onValueChange(\"readableBackground\", e.target.value)} />\r\n            </label>\r\n\r\n            <label className=\"form-label\">\r\n              Adjustment Mode\r\n\r\n              <select className=\"config-input-text\"\r\n                value={this.state.config.readableMode}\r\n                onChange={(e) => this.onValueChange(\"readableMode\", +e.target.value)}>\r\n                <option value=\"1\">HSL Luma (FFZ Default)</option>\r\n                <option value=\"2\">Luv Luma</option>\r\n                <option value=\"3\">HSL Loop (BTTV-like)</option>\r\n                <option value=\"4\">RGB Loop</option>\r\n              </select>\r\n            </label>\r\n          </div>\r\n        </>\r\n      ) : null}\r\n\r\n      {this.state.config.dropShadow ? (\r\n        <>\r\n          <h4 className=\"form-group-header\">Shadow Options</h4>\r\n\r\n          <div className=\"form-group\">\r\n            <label className=\"form-label\">\r\n              Offset\r\n              <input type=\"text\"\r\n                className=\"config-input-text config-input-number\"\r\n                placeholder=\"Shadow Offset\"\r\n                size={1}\r\n                value={this.state.config.dropShadowOffset}\r\n                onChange={(e) => this.onValueChange(\"dropShadowOffset\", isNaN(+e.target.value) ? this.state.config.dropShadowOffset : +e.target.value)} />\r\n            </label>\r\n\r\n            <label className=\"form-label\">\r\n              Blur Radius\r\n              <input type=\"text\"\r\n                className=\"config-input-text config-input-number\"\r\n                placeholder=\"Shadow Blur Radius\"\r\n                size={1}\r\n                value={this.state.config.dropShadowBlur}\r\n                onChange={(e) => this.onValueChange(\"dropShadowBlur\", isNaN(+e.target.value) ? this.state.config.dropShadowBlur : +e.target.value)} />\r\n            </label>\r\n\r\n            <label className=\"form-label\">\r\n              Colour\r\n              <input type=\"color\"\r\n                className=\"config-input-text\"\r\n                size={1}\r\n                value={this.state.config.dropShadowColour}\r\n                onChange={(e) => this.onValueChange(\"dropShadowColour\", e.target.value)} />\r\n            </label>\r\n          </div>\r\n        </>\r\n      ) : null}\r\n\r\n\r\n      {this.state.config.outline ? (\r\n        <>\r\n          <h4 className=\"form-group-header\">Outline Options</h4>\r\n\r\n          <div className=\"form-group\">\r\n            <label className=\"form-label\">\r\n              Thickness\r\n              <input type=\"text\"\r\n                className=\"config-input-text config-input-number\"\r\n                placeholder=\"Outline Thickness\"\r\n                size={1}\r\n                value={this.state.config.outlineThickness}\r\n                onChange={(e) => this.onValueChange(\"outlineThickness\", isNaN(+e.target.value) ? this.state.config.outlineThickness : +e.target.value)} />\r\n            </label>\r\n\r\n            <label className=\"form-label\">\r\n              Colour\r\n              <input type=\"color\"\r\n                className=\"config-input-text\"\r\n                size={1}\r\n                value={this.state.config.outlineColour}\r\n                onChange={(e) => this.onValueChange(\"outlineColour\", e.target.value)} />\r\n            </label>\r\n          </div>\r\n        </>\r\n      ) : null}\r\n    </>)\r\n  }\r\n}","export default __webpack_public_path__ + \"static/media/error.c7775b14.svg\";","import { Component } from 'react';\r\nimport ErrorSvg from \"./images/error.svg\"\r\n\r\nexport class ApiError extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"chat-container\">\r\n        <div className=\"fatal-chat-error\">\r\n          <div>\r\n            <img src={ErrorSvg} width={64} />\r\n            <div>\r\n              <h4>This isn't a chatbox!</h4>\r\n              <p>Hi there, to continue using this chatbox, you'll need to reauthenticate with Twitch. Sorry! It's due to API requirements.</p>\r\n              <p>To re-authenticate, <a href=\"/chatbox-v2\" target='_blank'>click here</a>, or visit https://&#8203;wamwoowam.github.io&#8203;/chatbox-v2</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { App } from './App';\r\nimport './index.css';\r\n\r\n// this isn't needed in prod, as on the server it will be handled by its own HTML document\r\nif (window.location.pathname.startsWith(\"/chatbox-v2/auth\")) {\r\n  if (window.opener) {\r\n    (window.opener as any).postMessage(window.location.hash);\r\n    window.close();\r\n  }\r\n}\r\n\r\nReactDOM.render(\r\n  <App />,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}